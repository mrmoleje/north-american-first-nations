

library(readxl)
library(leaflet)
library(dplyr)
library(htmltools)
library(shiny)

#read in data----

d <-read_xlsx("massacres.xlsx")



ui <- {fluidPage("Massacres in North America involving First Nations Peoples:1500-1700", 
                 sidebarLayout(
                   sidebarPanel(
                     selectInput(inputId = "input1", label = "Name of tribe" ,choices = 
                                   unique(d$Tribe_name))
                     
                   ),
                   
                   mainPanel(
                     leafletOutput("mymap"))
                 )
)}


server <- function(input, output) {
  react <- reactive({
    req(input$input1)
    df <- d[d$T_name == input$input1, ] 
    df
  })
  output$mymap <- renderLeaflet({ req(input$input1)
    
    leaflet() %>% addTiles() %>% setView(lng = -100.94, lat = 38.94 , zoom 
                                         = 3.5) %>%
      addProviderTiles(providers$Esri.NatGeoWorldMap) %>%
      addMarkers(lng=react()$longitude, lat=react()$latitude,
                 popup = paste(d$massacre_name)
      )
  })
}


shinyApp(ui, server)
